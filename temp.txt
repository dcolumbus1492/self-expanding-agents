CORRECT FLOW:

  1. Primary Agent (Task tool only) → delegates to meta-agent
  2. Meta-agent → creates MCP server + specialist subagent → exits
  3. Phoenix restart → registers MCP tools
  4. Primary Agent (fresh session) → should see new specialist subagent
  5. Primary Agent → delegates original task to specialist subagent
  6. Specialist subagent → should see MCP tools and use them

  THE TWO CRITICAL QUESTIONS:

  Question 1: Does Primary Agent see the created specialist after restart?

  From our test results:
  - ✅ YES - Fresh sessions can see newly created subagents
  - ❌ NO - --continue cannot see new subagents

  So the fix to use fresh session instead of --continue solves this.

  Question 2: Does the specialist subagent see MCP tools?

  This depends on:
  - Tool Allowlist: The specialist needs --allowedTools including MCP tools
  - Fresh Context: The specialist needs fresh session context to see registered MCP tools

  THE REAL ISSUE:

  When primary agent delegates to the specialist subagent, does the specialist subagent inherit the
  MCP tool permissions from the primary agent's --allowedTools?

  We need to test: Does subagent tool delegation inherit the parent session's tool allowlist, or
  does each subagent get default tool access?

  This is the critical missing piece - subagent tool inheritance behavior.